%% Group_data
% Load groups mat file
% Add mouse data for each group into its corresponding group structure. 
% Save the structure.


%% Load groups mat file

if ~exist('groups.mat')
    groups = NaN(20, 2);
    save groups groups
else
    load('groups.mat')
end

% Make sure to enter mouse ID numbers into their appropriate columns
save groups groups

%% Put mouse data into group data 

% Add group names as needed. This will be used for saving purposes.
groupnames = {'TH+', 'TH-'};

columns = size(groups, 2);
num_mice = sum(~isnan(groups), 1); % returns number of mice per group

% For loop to collect all mouse data of a group into a structure
for i = 1:columns 
    
    groupS = struct('Precue', struct('Premature', [], ...
                                   'CorrGo', [], ...
                                   'InCorrGo', [], ...
                                   'CorrNoGo', [], ...
                                   'InCorrNoGo', []), ...
                  'Cue',    struct('CorrGo', [], ...
                                   'InCorrGo', [], ...
                                   'CorrNoGo', [], ...
                                   'InCorrNoGo', []), ...
                  'Reward', struct('CorrGo', [], ...
                                   'CorrNoGo', []), ...
                  'ITI',    struct('Premature', [], ...
                                   'CorrGo', [], ...
                                   'InCorrGo', [], ...
                                   'CorrNoGo', [], ...
                                   'InCorrNoGo', []));

                             
    for j = 1:num_mice(i)
        
        str = num2str(groups(j, i));
       
        windows = 0;
        data_path = '/Users/johnwen/Google Drive/Stanford Neuroscience Graduate School/Labs/Luis de Lecea/Data/Behavioral/OneDrive_3_3-25-2018';

        if windows
            load([data_path,'\',strcat(str, '-all-sessions-structure')]);
        else
            load([data_path,'/',strcat(str, '-all-sessions-structure')]);
        end

        % Add mouse data to group structure

        % Collecting Precue Data
        groupS.Precue.Premature = [groupS.Precue.Premature; mouseS.Precue.Premature];
        groupS.Precue.CorrGo = [groupS.Precue.CorrGo; mouseS.Precue.CorrGo];
        groupS.Precue.CorrNoGo = [groupS.Precue.CorrNoGo; mouseS.Precue.CorrNoGo];
        groupS.Precue.InCorrGo = [groupS.Precue.InCorrGo; mouseS.Precue.InCorrGo];
        groupS.Precue.InCorrNoGo = [groupS.Precue.InCorrNoGo; mouseS.Precue.InCorrNoGo];   

        % Collecting Cue Data
        groupS.Cue.CorrGo = [groupS.Cue.CorrGo; mouseS.Cue.CorrGo];
        groupS.Cue.CorrNoGo = [groupS.Cue.CorrNoGo; mouseS.Cue.CorrNoGo];
        groupS.Cue.InCorrGo = [groupS.Cue.InCorrGo; mouseS.Cue.InCorrGo];
        groupS.Cue.InCorrNoGo = [groupS.Cue.InCorrNoGo; mouseS.Cue.InCorrNoGo];

        % Collecting Reward Data
        groupS.Reward.CorrGo = [groupS.Reward.CorrGo; mouseS.Reward.CorrGo];
        groupS.Reward.CorrNoGo = [groupS.Reward.CorrNoGo; mouseS.Reward.CorrNoGo];

        % Collecting ITI Data
        groupS.ITI.Premature = [groupS.ITI.Premature; mouseS.ITI.Premature];
        groupS.ITI.CorrGo = [groupS.ITI.CorrGo; mouseS.ITI.CorrGo];
        groupS.ITI.CorrNoGo = [groupS.ITI.CorrNoGo; mouseS.ITI.CorrNoGo];
        groupS.ITI.InCorrGo = [groupS.ITI.InCorrGo; mouseS.ITI.InCorrGo];
        groupS.ITI.InCorrNoGo = [groupS.ITI.InCorrNoGo; mouseS.ITI.InCorrNoGo];   
        
        filename = strcat(groupnames{i}, '_group_structure');

        save(filename, 'groupS');

    end
   
end
